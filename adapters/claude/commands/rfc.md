# /rfc - RFC作成コマンド

以下の手順に従い、RFCドキュメントを作成せよ。

## 元ネタ文章

$ARGUMENTS

## 実行手順

### Step 1: 元ネタ文章の取得

上記「元ネタ文章」が空の場合は、「RFCの元ネタを入力してください。」とだけ表示し、ユーザの次のメッセージを待て。入力がある場合はそれを元ネタ文章として使用する。

### Step 2: slug生成

元ネタ文章を要約し、以下の仕様でslugを生成せよ。

- 形式: `YYYYMMDD-slugstr`
- `YYYYMMDD`: JST（日本標準時間, UTC+9）の今日の日付
- `slugstr`: 元ネタ文章の内容を要約した、**最大30文字**の全小文字ケバブケース英数字（a-z, 0-9, ハイフンのみ）

### Step 3: ブランチ作成

`main` ブランチから `feature/<slug>` ブランチを作成し、チェックアウトせよ。

### Step 4: ディレクトリ作成

カレントリポジトリのルート（`git rev-parse --show-toplevel`）を基準に `docs/rfcs/<slug>/` ディレクトリを作成せよ。同名のディレクトリが既に存在する場合は、slugstr の末尾に連番（`-2`, `-3`, ...）を付与して重複を回避せよ。

### Step 5: 要件ヒアリング

元ネタ文章を分析し、RFC起草に必要な情報が不足・曖昧な場合は、起草前にユーザへ質問して要件を明確化せよ。十分に明確な場合はこのステップをスキップしてよい。

### Step 6: コードベース調査

元ネタ文章に関連するコードベースを調査し、現行アーキテクチャ・データモデル・依存関係を把握せよ。調査結果は Step 7 の起草時に「背景・動機」「詳細設計」へ反映する。

### Step 7: RFC起草

1. `~/projects/vdev/prompts/roles/rfc-author.md` を読み込み、その人格に切り替わる。
2. `~/projects/vdev/templates/rfc/rfc-default.md` のテンプレート構造に従い、元ネタ文章とコードベース調査結果をもとにRFCを起草する。
3. ステータスは「Draft (起草中)」、作成日は今日のJST日付（YYYY-MM-DD形式）とする。
4. 起草した内容を `docs/rfcs/<slug>/rfc.md` に書き込む。

### Step 8: DoD自己チェック

起草したRFCが以下の完了定義を満たしているか自己チェックし、不足があれば補完せよ。

- [ ] 背景・動機が記述されていること
- [ ] 目的・スコープ（Goals / Non-Goals）が明確であること
- [ ] 具体的な設計案が記述されていること
- [ ] 代替案とその比較（トレードオフ）が示されていること
- [ ] 実装・リリース計画に検証方法が含まれていること

### Step 9: コミット & プッシュ

1. `docs/rfcs/<slug>/rfc.md` をステージングし、コミットメッセージ `docs: add RFC draft for <slug>` でコミットする。
2. `feature/<slug>` ブランチをリモートにプッシュする。
3. 完了後、作成したRFCのファイルパスとブランチ名をユーザに報告せよ。
