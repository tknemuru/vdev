# RFC-driven Development Workflow

## 1. 目的

コードの実装に先立ち「設計の合意」を形成することで、手戻りの最小化と技術的負債の抑制を図る。

## 2. 開発ライフサイクル

開発は以下の4ステージを経る。

### Stage 1: Drafting (RFC作成)

- **概要**: 解決すべき課題と提案する設計をドキュメント化する。
- **コマンド**: `/rfc`
- **成果物**: `docs/rfcs/<slug>/rfc.md`
- **DoD (完了定義)**:
  - 背景、目的、具体的設計案、検証方法が記述されていること。
  - 実装に伴うトレードオフ（代替案とその比較）が示されていること。
- **完了時の状態**: `feature/<slug>` ブランチに push 済み、Draft PR 作成済み。

### Stage 2: Reviewing (設計レビュー)

- **概要**: 3つのレビュー人格がRFCを並列レビューする。
- **コマンド**: `/rrfc`（レビュー）、`/urfc`（修正）
- **成果物**: `docs/rfcs/<slug>/review-*.md`
- **DoD (完了定義)**:
  - 全レビュアーによる Approve が得られていること。
  - P0 指摘事項がすべて解決されていること。
- **完了時の状態**: RFC ステータスを「Accepted (承認済)」に更新。

### Stage 3: Implementing (実装)

- **概要**: 承認されたRFCに基づき、コードを実装する。
- **コマンド**: `/imp`（実装）、`/rimp`（レビュー）、`/uimp`（修正）
- **成果物**: 実装コード、テストコード、`docs/rfcs/<slug>/review-imp-*.md`
- **DoD (完了定義)**:
  - RFC で定義した検証計画をパスしていること。
  - 変更内容が RFC の設計意図と整合していること。
  - 全レビュアーによる Approve が得られていること。
- **完了時の状態**: PR が Ready 状態、人間による最終確認待ち。

### Stage 4: Closing (完了)

- **概要**: 人間が PR を最終確認し、マージする。
- **DoD (完了定義)**:
  - PR がマージされていること。
  - RFC ステータスが最終状態に更新されていること。

## 3. 運用ルール

- **No RFC, No Code**: 原則として、RFC による設計合意なしに `main` ブランチへ向けた実装を開始してはならない。
- **Living Document**: 設計は実装中に変化しうる。その場合、コードだけでなく RFC も最新の状態に更新し、差異を発生させないこと。
- **Traceability**: すべてのコード変更（PR）は、対応する RFC（`docs/rfcs/<slug>/rfc.md`）へのリンクを含まなければならない。
