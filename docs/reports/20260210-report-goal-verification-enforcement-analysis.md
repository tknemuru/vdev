# RFC Goals 達成確認の強制化 — 問題分析と改善提案

| 項目 | 内容 |
|:---|:---|
| **作成日** | 2026-02-10 |
| **種別** | report |
| **関連RFC** | `docs/rfcs/20260209-enforce-rfc-goal-verification/rfc.md` |
| **関連PR** | [tknemuru/dre#56](https://github.com/tknemuru/dre/pull/56) |

## 1. 背景

RFC の「目的 (Goals)」の達成強制力が弱く、達成したかどうかを判断する情報がないという課題に対し、RFC `20260209-enforce-rfc-goal-verification` を作成・実装した。変更内容は以下4点:

1. RFC テンプレートの Goals をテーブル形式にし、達成確認方法 (Verification) 列を必須化
2. RFC レビュー基準に Goals の検証可能性チェックを追加
3. `/imp` コマンドに Goals 達成確認ステップを追加
4. 実装レビュー基準に Goals 達成エビデンス確認を追加

しかし、改善後の初回適用事例（dre リポジトリ PR #56）で Verification・エビデンスが形骸化していることが判明した。

## 2. 問題の分析

### 2.1 実例: dre PR #56 の Goals 達成確認テーブル

| # | RFC の Verification（要約） | PR のエビデンス（要約） | 問題 |
|---|---|---|---|
| G1 | `/explore` 実行後、`feedback-log.md` に APPROVE エントリが存在し、Architect が 5分以内にタスク完了 | 「ポーリングスクリプトを追記済み」 | コードを書いたことがエビデンスになっている。実行して動作を確認していない |
| G2 | `/explore` 実行後、リードが手動 sleep なしで完了検出できること | 「Step 3.5 を追加。ポーリングスクリプトを明記」 | 同上 |
| G3 | `explore.md` にタイムアウト手順の記載があること | 「Step 6 を追加。タイムアウト等を明記」 | Verification 自体が「記載があること」であり、実装すれば自動的に達成するトートロジー |
| G4 | Kindle CSV なしでスクリプト実行しエラーが出ないこと | 「ディレクトリ不在で実行しエラーなしを確認済み」 | 「実行した」と言っているがコマンド出力等の具体的エビデンスがない |

### 2.2 問題は2段階ある

**問題A: RFC 作成時の Verification 設定が甘い**

G3 は「記載があること」という Verification であり、実装すれば自動的に達成するトートロジーになっている。このような Verification は Goals の達成確認として機能しない。

**問題B: `/imp` の Goals 達成確認ステップが形骸化している**

G1, G2 では RFC に「実行して確認」と書いてあるにもかかわらず、実装側は「コードを書いたことの目視確認」をエビデンスとして提出している。Verification の指示を無視している。

### 2.3 根本原因

現在の `/imp` Step 7 には以下の指示がある:

> 各 Goal の Verification を順に実行する（コマンド実行、テスト結果確認、ファイル内容の目視確認など）

**「目視確認など」が逃げ道になっている。** AI は最も低コストな「目視確認」に流れ、実際にコマンドを実行したり動作を検証したりしない。

さらに、Verification 自体が「記載があること」のように **トートロジー的に設定できてしまう** 問題も残っている。

## 3. 改善提案

### 提案1: `/imp` の Goals 達成確認ステップを厳格化する

`adapters/claude/commands/imp.md` の Step 7 を以下のように修正:

```markdown
### Step 7: Goals 達成確認

1. Step 3 で読み込んだ RFC の Goals テーブルから、各 Goal の `#`、`Goal`、`達成確認方法 (Verification)` を抽出する。
2. 各 Goal の Verification を順に実行する。
   - Verification に記載されたコマンド・手順を**そのまま実行**せよ。
   - 「目視確認」「記載があること」等の確認は、対象ファイルの該当箇所を Read で読み込み、期待する内容が存在することを引用で示せ。
   - **「〜を追記済み」「〜を実装済み」はエビデンスとして認めない。** 実装したことは diff から自明であり、Verification の目的は「実装した結果として目的が達成されたか」の確認である。
3. 達成確認結果を以下のテーブル形式でまとめる:

| # | Goal | Verification | 結果 | エビデンス |
|---|------|-------------|------|-----------|
| G1 | {Goal内容} | {確認方法} | OK / NG | {**実行したコマンドの出力、読み込んだファイルの該当箇所の引用、スクリーンショットのパスなど**} |

4. NG の Goal がある場合はユーザに報告し、続行するか確認する。
5. 達成確認結果は Step 8 の PR 作成時に本文へ含める。
```

### 提案2: RFC テンプレートの Verification 記述ガイドを強化する

`templates/rfc/rfc-default.md` の Goals テーブルの説明を修正:

```markdown
### 目的 (Goals)

| # | Goal | 達成確認方法 (Verification) |
|---|------|-----------------------------|
| G1 | {達成すべき具体的な目標} | {実装完了後に達成を検証する具体的手順。「記載があること」のような実装と同義の確認は不可。コマンド実行結果、テスト通過、動作確認手順など、実装とは独立した検証手段を記述すること} |
```

### 提案3: RFC レビュー基準に「トートロジー検出」を追加

`prompts/criterias/rfc-review.md` の Approach Reviewer の Verification チェック項目を強化:

```markdown
- 各 Goal に対して具体的な達成確認方法（Verification）が定義されているか。以下に該当する場合は P0 として指摘すること:
  - 「検討する」「評価する」等の曖昧な記述
  - 「〜が記載されていること」「〜が追加されていること」等、実装完了と同義になるトートロジー的な確認方法
  - 実行可能な確認手順（計測コマンド、テストケース、動作確認手順等）が示されていないもの
```

### 提案4: 実装レビュー基準のエビデンス検証を厳格化

`prompts/criterias/impl-review.md` の Approach Reviewer の項目を強化:

```markdown
- RFC の各 Goal に対する達成確認結果（エビデンス）がPRに記載されているか。以下に該当する場合は P0 として指摘すること:
  - エビデンスが「〜を実装済み」「〜を追記済み」等、実装行為の記述にとどまるもの（実装は diff から自明であり、エビデンスではない）
  - Verification に記載されたコマンドや手順を実行した結果が示されていないもの
  - エビデンスが不足または不明確なもの
```

## 4. まとめ

Goals の達成確認を強制する仕組みは導入できたが、**仕組みの「抜け穴」** が2つ残っていた:

1. **Verification のトートロジー**: 「記載があること」のような、実装と同義の確認方法を設定できてしまう
2. **エビデンスの形骸化**: 「実装済み」を エビデンスとして記載でき、実際の動作確認が行われない

提案1〜4はこれらの抜け穴を塞ぐものであり、RFC テンプレート・レビュー基準・実装コマンド・実装レビュー基準の4箇所を同時に修正することで一貫性を確保する。
